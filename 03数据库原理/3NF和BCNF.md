# 3NF和BCNF记录

# 1、3NF与BCNF区别

相对于BCNF来说，3NF允许存在主属性对候选码的传递依赖和部分依赖。

举个例子：在学生信息表中，学号是一个候选码，学号可确定学生姓名；（班级，学生姓名）也是一组候选码，（班级，学生姓名）->学号，因此主属性之间形成了传递依赖。



# 2、3NF求解

## 2.1 求解步骤

1. 求正则覆盖与候选码（合并最小函数依赖集$F_{m}$，A->B，A->C合并为：A->BC）
2. 转换函数依赖（->）为:$R_{1,2...}$
3. 验证所有关系模式$R_{x}（x=1,2....）$是否包含候选码，若不包含则添加任意一个候选码即可
4. 如果一个模式被另一个模式包含，去除被包含的关系模式

## 2.2 3NF分解例题

### 2.2.1 例题1

例1：U={A,B,C,D,E,G}，F={B->G，CE->B，C->A，CE->G，B->D，C->D}分解为3NF

**<font color="#ff0000">答：</font>**

1. 求解正则覆盖与候选码

   ```
   正则覆盖结果:
   {B->DG，CE->B，C->AD}
   候选码:CE
   ```

2. 转换函数依赖

   ```
   R1(BDG)
   R2(CEB)
   R3(CAD)
   ```

3. 验证函数依赖是否包含候选码

   ```
   候选码:CE
   ---
   R1(BDG)  不包含候选码CE
   R2(CEB)  包含候选码CE
   R3(CAD)  不包含候选码CE
   ```

4. 验证是否去除

   ```
   R1、R2、R3之间没有包含关系
   ```

   综上：3NF分解为：R1(BDG)、R2(CEB)、R3(CAD)

   >此时3NF已经是保持函数依赖与无损分解

### 2.2.2 例题2

# 3、BCNF求解

## 3.1 求解步骤

1. 最小函数依赖集$F_{m}$与候选码
2. 对于取$F_{m}$中函数依赖左侧不是候选码的函数依赖(X->Y)，进行分解:
   1. R1=XY
   2. R2=（R-R1）U   X （解释一下：R去掉函数依赖R1，与->左侧取并集）
   3. F2={...}去掉Y的所有函数依赖
3. 对F2进行重复上一步计算
4. 直到所有条件满足

## 3.2 BCNF分解例题

### 3.2.1 例题1

例题1：R（A，B，C，D，E），F={A->C，C->D ,B->C,DE->C,CE->A}分解为BCNF

**<font color="#ff0000">答：</font>**

1. 求解$F_{m}$与候选码

   ```
   F={A->C，C->D ,B->C,DE->C,CE->A}
   候选码：BE
   ```

2. 取函数依赖左侧不是候选码的函数依赖(X->Y)，进行分解:

   ```Java
   1.函数依赖左侧未找到候选码BE对应函数依赖（BE->...）
   2.先看第一项A->C
   	（1）分解为R1（AC）
   	（2）R2=（R-R1）U A，则：R-R1=BDE,再与依赖左侧A取并集，有：ABDE即R2=ABDE
   	 (3)去掉函数依赖右侧属性C以后的函数依赖有：
       	F2={A->D(A推C，C推D得来，其他同理),B->D,DE->D,BE->A,DE->A}
   ```

3. 重复以上步骤

```
F2={A->D(A推C，C推D得来，其他同理),B->D,DE->D,BE->A,DE->A}
1.函数依赖左侧未找到候选码BE对应函数依赖（BE->...）
2.先看第一项A->D
	（1）分解为R21（AD）
	（2）R22=（R-R1）U A，则：R2-R21=BE,再与依赖左侧A取并集，有：ABE即R2=ABE
	 (3)去掉函数依赖右侧属性D以后的函数依赖有：
    	F2={A->D(A推C，C推D得来，其他同理),B->D,DE->D,BE->A,DE->A}
    	--->
    	F22={BE->A} 
    	
    	
--------
重复以上步骤:	F22={BE->A} 函数依赖左侧已找到候选码BE对应函数依赖（BE->A）即为R3(ABE)

综上：BCNF分解为：(AC)、（AD）、（ABE）
```

U={A,B,C,D,E,F}

F={AE->F,A->B,BC->D,CD->A,CE->F}

候选码：ACE、BCE、DCE

R1(AEF)   R2(ABCDE)  F2={A->B,BC->D,CD->A}

R3(AB)    R4(ACDE)  F3={CD->A}

R5(CDA)  R6 (CDE)    